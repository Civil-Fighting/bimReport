/*
 * Copyright CADMAI Software GmbH.
 * All rights reserved.
 *
 * Redistribution (includes making available on a web location) is permitted 
 * provided that the following conditions are met:
 *
 * The redistributor must hold one of these licenses:
 * a valid CADMAI WebGl-Publisher license (SingleWebGlPubLic)
 * a valid CADMAI WebGl-Publisher Revit export license (SingleWebGlRevitExportLic)
 * a valid CADMAI WebGl-Publisher Inventor export license (SingleWebGlInventorExportLic)
 * or a written permission of CADMAI Software GmbH 
 *
 * The redistributor / user does not have the right to change, translate,
 * back-develop, decompile or disassemble the software.
 * 
 * Redistributions must retain the above copyright notice, 
 * this list of conditions and the following disclaimer.
 *   
 * Neither the name of CADMAI Software GmbH nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
 "\x75\x73\x65\x20\x73\x74\x72\x69\x63\x74";var CmiWebAccessAdmin=function(){var tG=false;var Du=null;var cc="";var zd="\x2e\x2f\x43\x6d\x69\x41\x63\x63\x65\x73\x73\x2f";var rS=new BJ("","","");var qf=false;var TF=false;var xY=1;this.getLastError=function(){return rS;};this.setAdminPassword=function(Fh){cc=Fh;};this.setWebAccessLocation=function(kz){zd=kz;};this.getResponseErrorCode=function(){if(Du!=null)return(Du.errorCode);else return("\x45\x72\x72\x6f\x72\x20\x72\x65\x61\x64\x69\x6e\x67\x20\x72\x65\x73\x70\x6f\x6e\x73\x65");};this.getResponseValue=function(){if(Du!=null)return(Du.responseValue);else return("\x45\x72\x72\x6f\x72\x20\x72\x65\x61\x64\x69\x6e\x67\x20\x72\x65\x73\x70\x6f\x6e\x73\x65");};this.getResponseData=function(){if(Du!=null)return(Du.cmiData);else return("\x45\x72\x72\x6f\x72\x20\x72\x65\x61\x64\x69\x6e\x67\x20\x72\x65\x73\x70\x6f\x6e\x73\x65");};this.getResponseContext=function(){if(Du!=null)return(Du.cmiWebAccessContext);else return("\x45\x72\x72\x6f\x72\x20\x72\x65\x61\x64\x69\x6e\x67\x20\x72\x65\x73\x70\x6f\x6e\x73\x65");};this.getIsReconnected=function(){return qf;};this.setIsReconnected=function(hw){qf=hw;};this.s=function(QM,MF,kV){rS.name=QM;rS.message=MF;rS.context=kV;if(TF){var O="\x43\x4d\x49\x5f\x45\x52\x52\x4f\x52\x7c"+QM+"\x7c"+MF;this.sendCmiNotification(O);}};this.Im=function(){rS.name="";rS.message="";rS.context="";};this.pz=function(IC){Du=CmiHelpers.aJ(IC,this);if(Du.errorCode!="\x53\x55\x43\x43\x45\x53\x53"){this.s(Du.errorCode,Du.responseValue,"\x41\x4a\x41\x58\x5f\x45\x52\x52\x4f\x52");}};this.setNotificationHandler=function(JJ){if(document.addEventListener)window.addEventListener("\x6d\x65\x73\x73\x61\x67\x65",JJ,false);else if(document.attachEvent)window.attachEvent("\x6f\x6e\x6d\x65\x73\x73\x61\x67\x65",JJ);TF=true;return 0;};this.sendCmiNotification=function(O){if(TF==false)return-1;var VR=CmiHelpers.lq(O,xY);if(VR==null){TF=false;this.s("\x43\x6d\x69\x57\x69\x6e\x64\x6f\x77\x2e\x73\x65\x6e\x64\x43\x6d\x69\x4e\x6f\x74\x69\x66\x69\x63\x61\x74\x69\x6f\x6e","\x59\x6f\x75\x72\x20\x62\x72\x6f\x77\x73\x65\x72\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x73\x75\x70\x70\x6f\x72\x74\x20\x6d\x65\x73\x73\x61\x67\x65\x20\x65\x76\x65\x6e\x74\x73","\x53\x43\x52\x49\x50\x54\x5f\x45\x52\x52\x4f\x52");return-1;}else{window.dispatchEvent(VR);xY++;}return 0;};this.Sy=function(){try{return new XMLHttpRequest();}catch(e){}try{return new ActiveXObject("\x4d\x69\x63\x72\x6f\x73\x6f\x66\x74\x2e\x58\x4d\x4c\x48\x54\x54\x50");}catch(e){}try{return new ActiveXObject("\x4d\x73\x78\x6d\x6c\x32\x2e\x58\x4d\x4c\x48\x54\x54\x50");}catch(e){}return null;};this.SU=function(J5){if(tG)this.jO(J5);else this.sP(J5);};this.jO=function(J5){var X;var NK=zd+"\x43\x6d\x69\x57\x65\x62\x41\x63\x63\x65\x73\x73\x2e\x64\x6c\x6c\x3f"+J5;var X=this.Sy();if(X!=null){try{X.open("\x67\x65\x74",NK,false);X.send(null);}catch(J){this.s(J.name,J.message+"\x20\x28\x70\x6f\x73\x73\x69\x62\x6c\x65\x20\x63\x61\x6c\x6c\x20\x66\x72\x6f\x6d\x20\x66\x69\x6c\x65\x3a\x2f\x2f\x20\x55\x52\x4c\x29","\x53\x54\x44\x5f\x45\x52\x52\x52\x4f\x52");return-1;}if(X.status!=200){this.s("\x43\x6d\x69\x57\x65\x62\x41\x63\x63\x65\x73\x73\x2e\x63\x6d\x69\x53\x65\x6e\x64\x53\x79\x6e\x63\x41\x6a\x61\x78\x52\x65\x71\x75\x65\x73\x74","\x45\x72\x72\x6f\x72\x20\x73\x65\x6e\x64\x69\x6e\x67\x20\x58\x4d\x4c\x48\x74\x74\x70\x52\x65\x71\x75\x65\x73\x74\x73","\x53\x43\x52\x49\x50\x54\x5f\x45\x52\x52\x4f\x52");return-1;}if(X.responseText!=undefined){this.pz(X.responseText);return 0;}else{this.s("\x43\x6d\x69\x57\x65\x62\x41\x63\x63\x65\x73\x73\x2e\x63\x6d\x69\x53\x65\x6e\x64\x53\x79\x6e\x63\x41\x6a\x61\x78\x52\x65\x71\x75\x65\x73\x74","\x4e\x6f\x20\x72\x65\x73\x70\x6f\x6e\x73\x65\x20\x72\x65\x63\x65\x69\x76\x65\x64","\x53\x54\x44\x5f\x45\x52\x52\x52\x4f\x52");return-1;};}else{this.s("\x43\x6d\x69\x57\x65\x62\x41\x63\x63\x65\x73\x73\x2e\x63\x6d\x69\x53\x65\x6e\x64\x53\x79\x6e\x63\x41\x6a\x61\x78\x52\x65\x71\x75\x65\x73\x74","\x59\x6f\x75\x72\x20\x62\x72\x6f\x77\x73\x65\x72\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x73\x75\x70\x70\x6f\x72\x74\x20\x58\x4d\x4c\x48\x74\x74\x70\x52\x65\x71\x75\x65\x73\x74\x73","\x53\x43\x52\x49\x50\x54\x5f\x45\x52\x52\x4f\x52");return-1;}return-1;};this.sP=function(J5){var X;var NK=zd+"\x43\x6d\x69\x57\x65\x62\x41\x63\x63\x65\x73\x73\x2e\x64\x6c\x6c\x3f"+J5;var X=this.Sy();if(X!=null){CmiHelpers.addEventListener(X,"\x6c\x6f\x61\x64",this.Z_,this);CmiHelpers.addEventListener(X,"\x65\x72\x72\x6f\x72",this.Bx,this);try{X.open("\x67\x65\x74",NK,true);X.send(null);return 0;}catch(J){this.s(J.name,J.message+"\x20\x28\x70\x6f\x73\x73\x69\x62\x6c\x65\x20\x63\x61\x6c\x6c\x20\x66\x72\x6f\x6d\x20\x66\x69\x6c\x65\x3a\x2f\x2f\x20\x55\x52\x4c\x29","\x53\x54\x44\x5f\x45\x52\x52\x52\x4f\x52");return-1;};}else{this.s("\x43\x6d\x69\x57\x65\x62\x41\x63\x63\x65\x73\x73\x2e\x63\x6d\x69\x53\x65\x6e\x64\x53\x74\x64\x41\x6a\x61\x78\x52\x65\x71\x75\x65\x73\x74","\x59\x6f\x75\x72\x20\x62\x72\x6f\x77\x73\x65\x72\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x73\x75\x70\x70\x6f\x72\x74\x20\x58\x4d\x4c\x48\x74\x74\x70\x52\x65\x71\x75\x65\x73\x74\x73","\x53\x43\x52\x49\x50\x54\x5f\x45\x52\x52\x4f\x52");return-1;}return 0;};this.Z_=function(k){var X=k.target;switch(X.readyState){case 4:if(X.status!=200){this.s("\x43\x6d\x69\x57\x65\x62\x41\x63\x63\x65\x73\x73\x2e\x63\x6d\x69\x53\x65\x6e\x64\x53\x74\x64\x41\x6a\x61\x78\x52\x65\x71\x75\x65\x73\x74","\x45\x72\x72\x6f\x72\x20\x73\x65\x6e\x64\x69\x6e\x67\x20\x58\x4d\x4c\x48\x74\x74\x70\x52\x65\x71\x75\x65\x73\x74\x73","\x53\x43\x52\x49\x50\x54\x5f\x45\x52\x52\x4f\x52");return-1;}if((X.responseText!=undefined)&&(X.responseText.indexOf("\x63\x6d\x69\x41\x6a\x61\x78\x52\x65\x73\x70\x6f\x6e\x73\x65")!=-1)){this.pz(X.responseText);if(this.getResponseErrorCode()=="\x53\x55\x43\x43\x45\x53\x53"){this.Im();if(this.getResponseContext()=="\x43\x72\x65\x61\x74\x65\x43\x61\x64\x6d\x61\x69\x53\x65\x73\x73\x69\x6f\x6e"){this.setIsReconnected(false);}else if(this.getResponseContext()=="\x43\x6f\x6e\x6e\x65\x63\x74\x32\x43\x61\x64\x6d\x61\x69\x53\x65\x73\x73\x69\x6f\x6e"){this.setIsReconnected(true);}var O="\x43\x4d\x49\x5f\x49\x4e\x46\x4f\x7c\x52\x65\x71\x75\x65\x73\x74\x52\x65\x73\x75\x6c\x74\x52\x65\x63\x65\x69\x76\x65\x64";this.sendCmiNotification(O);};}else{this.s("\x43\x6d\x69\x57\x65\x62\x41\x63\x63\x65\x73\x73\x2e\x63\x6d\x69\x53\x65\x6e\x64\x53\x74\x64\x41\x6a\x61\x78\x52\x65\x71\x75\x65\x73\x74","\x4e\x6f\x20\x72\x65\x73\x70\x6f\x6e\x73\x65\x20\x72\x65\x63\x65\x69\x76\x65\x64\x20\x73\x74\x61\x74\x75\x73\x20\x74\x65\x78\x74\x20\x3d"+X.statusText+"\x20\x73\x74\x61\x74\x75\x73\x20\x3d"+X.status,"\x53\x43\x52\x49\x50\x54\x5f\x45\x52\x52\x4f\x52");}break;};};this.Bx=function(k){var X=k.target;;this.s("\x43\x6d\x69\x57\x65\x62\x41\x63\x63\x65\x73\x73\x2e\x72\x65\x71\x75\x65\x73\x74\x45\x72\x72\x6f\x72","\x43\x6f\x75\x6c\x64\x20\x6e\x6f\x74\x20\x6c\x6f\x61\x64\x20\x6d\x6f\x64\x65\x6c\x2c\x20\x73\x74\x61\x74\x75\x73\x20\x74\x65\x78\x74\x20\x3d"+X.statusText+"\x20\x73\x74\x61\x74\x75\x73\x20\x3d"+X.status,"\x53\x43\x52\x49\x50\x54\x5f\x45\x52\x52\x4f\x52");};this.checkServerConnection=function(){var J=this.SU("\x57\x65\x62\x41\x63\x63\x65\x73\x73\x43\x6f\x6e\x6e\x65\x63\x74\x69\x6f\x6e\x54\x65\x73\x74");return J;};this.getWebAccessSettings=function(){var J=this.SU("\x47\x65\x74\x57\x65\x62\x41\x63\x63\x65\x73\x73\x53\x65\x74\x74\x69\x6e\x67\x73");return J;};this.setServerLogging=function(qn){var J5;if(qn)J5="\x45\x6e\x61\x62\x6c\x65\x4c\x6f\x67\x67\x69\x6e\x67\x3d\x74\x72\x75\x65\x26\x41\x64\x6d\x50\x77\x64\x3d"+cc;else J5="\x45\x6e\x61\x62\x6c\x65\x4c\x6f\x67\x67\x69\x6e\x67\x3d\x66\x61\x6c\x73\x65\x26\x41\x64\x6d\x50\x77\x64\x3d"+cc;return(this.SU(J5));};this.setSessionAutoCleanup=function(W6){var J5;if(W6)J5="\x45\x6e\x61\x62\x6c\x65\x43\x6c\x65\x61\x6e\x75\x70\x3d\x74\x72\x75\x65\x26\x41\x64\x6d\x50\x77\x64\x3d"+cc;else J5="\x45\x6e\x61\x62\x6c\x65\x43\x6c\x65\x61\x6e\x75\x70\x3d\x66\x61\x6c\x73\x65\x26\x41\x64\x6d\x50\x77\x64\x3d"+cc;return(this.SU(J5));};this.setSessionTimeout=function(timeout){var J5="\x43\x6f\x6e\x6e\x65\x63\x74\x69\x6f\x6e\x54\x69\x6d\x65\x6f\x75\x74\x3d"+timeout+"\x26\x41\x64\x6d\x50\x77\x64\x3d"+cc;return(this.SU(J5));};this.cleanupServerSessions=function(){var J5="\x43\x6c\x65\x61\x6e\x75\x70\x43\x61\x64\x6d\x61\x69\x53\x65\x73\x73\x69\x6f\x6e\x73\x26\x41\x64\x6d\x50\x77\x64\x3d"+cc;return(this.SU(J5));};this.destroyAllServerSessions=function(){var J5="\x44\x65\x73\x74\x72\x6f\x79\x43\x61\x64\x6d\x61\x69\x53\x65\x73\x73\x69\x6f\x6e\x73\x26\x41\x64\x6d\x50\x77\x64\x3d"+cc;return(this.SU(J5));};this.getServerList=function(){var J5="\x47\x65\x74\x53\x65\x72\x76\x65\x72\x4c\x69\x73\x74\x26\x41\x64\x6d\x50\x77\x64\x3d"+cc;return(this.SU(J5));};this.getSessionList=function(){var J5="\x47\x65\x74\x53\x65\x73\x73\x69\x6f\x6e\x4c\x69\x73\x74\x26\x41\x64\x6d\x50\x77\x64\x3d"+cc;return(this.SU(J5));};this.removeCadmaiServer=function(Uc){var J5="\x52\x65\x6d\x6f\x76\x65\x43\x61\x64\x6d\x61\x69\x53\x65\x72\x76\x65\x72\x26\x53\x65\x72\x76\x65\x72\x4e\x61\x6d\x65\x3d"+Uc+"\x26\x41\x64\x6d\x50\x77\x64\x3d"+cc;return(this.SU(J5));};this.addCadmaiServer=function(Uc,tC,P1){var J5="\x41\x64\x64\x43\x61\x64\x6d\x61\x69\x53\x65\x72\x76\x65\x72\x26\x53\x65\x72\x76\x65\x72\x4e\x61\x6d\x65\x3d"+Uc+"\x26\x4c\x6f\x67\x69\x6e\x4e\x61\x6d\x65\x3d"+tC+"\x26\x4c\x6f\x67\x69\x6e\x50\x77\x64\x3d"+P1+"\x26\x41\x64\x6d\x50\x77\x64\x3d"+cc;return(this.SU(J5));};this.createServerSession=function(){var J5="\x43\x72\x65\x61\x74\x65\x43\x61\x64\x6d\x61\x69\x53\x65\x73\x73\x69\x6f\x6e\x26\x41\x64\x6d\x50\x77\x64\x3d"+cc;return(this.SU(J5));};this.checkSessionConnection=function(sessionId){var J5="\x43\x61\x64\x6d\x61\x69\x53\x65\x73\x73\x69\x6f\x6e\x43\x6f\x6e\x6e\x65\x63\x74\x69\x6f\x6e\x54\x65\x73\x74\x26\x43\x6d\x69\x53\x65\x73\x73\x69\x6f\x6e\x49\x44\x3d"+sessionId;return(this.SU(J5));};this.keepCurrentSessionAlive=function(sessionId,rm){var J5;if(rm)J5="\x4b\x65\x65\x70\x53\x65\x73\x73\x69\x6f\x6e\x41\x6c\x69\x76\x65\x3d\x74\x72\x75\x65\x26\x43\x6d\x69\x53\x65\x73\x73\x69\x6f\x6e\x49\x44\x3d"+sessionId;else J5="\x4b\x65\x65\x70\x53\x65\x73\x73\x69\x6f\x6e\x41\x6c\x69\x76\x65\x3d\x66\x61\x6c\x73\x65\x26\x43\x6d\x69\x53\x65\x73\x73\x69\x6f\x6e\x49\x44\x3d"+sessionId;var J=this.SU(J5);return J;};this.killCmiSession=function(sessionId){var J5="\x4b\x69\x6c\x6c\x43\x6d\x69\x53\x65\x73\x73\x69\x6f\x6e\x26\x43\x6d\x69\x53\x65\x73\x73\x69\x6f\x6e\x49\x44\x3d"+sessionId;return(this.SU(J5));};};
